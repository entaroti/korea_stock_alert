name: Uptrend Stock Alert

on:
  schedule:
    # 매일 평일 오전 05:00 KST (UTC 기준 하루 전 20:00)
    - cron: "00 20 * * 0-4"
  workflow_dispatch:  # 수동 실행 가능

jobs:
  run-uptrend-alert:
    runs-on: ubuntu-latest

    steps:
    - name: Checkout repository
      uses: actions/checkout@v3

    - name: Set up Python
      uses: actions/setup-python@v4
      with:
        python-version: '3.10'

    - name: Install dependencies
      run: |
        python -m pip install --upgrade pip
        pip install pykrx pandas requests python-dotenv

    - name: Create .env file
      run: |
        echo "TELEGRAM_BOT_TOKEN=${{ secrets.TELEGRAM_BOT_TOKEN }}" >> .env
        echo "TELEGRAM_CHAT_ID=${{ secrets.TELEGRAM_CHAT_ID }}" >> .env

    - name: Run Uptrend Alert Script
      run: |
        python uptrend_alert.py
